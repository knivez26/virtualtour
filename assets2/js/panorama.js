window.libpannellum=function(e,t,a){function o(o){function h(e,t){return 1==e.level&&1!=t.level?-1:1==t.level&&1!=e.level?1:t.timestamp-e.timestamp}function c(e,t){return e.level!=t.level?e.level-t.level:e.diff-t.diff}function u(e,t,a,o,n,i){this.vertices=e,this.side=t,this.level=a,this.x=o,this.y=n,this.path=i.replace("%s",t).replace("%l",a).replace("%x",o).replace("%y",n)}function d(e,t,a,o,n){var i,r=t.vertices;i=g(e,r.slice(0,3));var s=g(e,r.slice(3,6)),l=g(e,r.slice(6,9)),r=g(e,r.slice(9,12)),h=i[0]+s[0]+l[0]+r[0];if(-4==h||4==h?i=!1:(h=i[1]+s[1]+l[1]+r[1],i=-4!=h&&4!=h&&4!=i[2]+s[2]+l[2]+r[2]),i){for(i=t.vertices,s=i[0]+i[3]+i[6]+i[9],l=i[1]+i[4]+i[7]+i[10],r=i[2]+i[5]+i[8]+i[11],h=Math.sqrt(s*s+l*l+r*r),r=Math.asin(r/h),s=Math.atan2(l,s)-o,s+=s>Math.PI?-2*Math.PI:s<-Math.PI?2*Math.PI:0,s=Math.abs(s),t.diff=Math.acos(Math.sin(a)*Math.sin(r)+Math.cos(a)*Math.cos(r)*Math.cos(s)),s=!1,l=0;l<w.nodeCache.length;l++)if(w.nodeCache[l].path==t.path){s=!0,w.nodeCache[l].timestamp=w.nodeCacheTimestamp++,w.nodeCache[l].diff=t.diff,w.currentNodes.push(w.nodeCache[l]);break}if(s||(t.timestamp=w.nodeCacheTimestamp++,w.currentNodes.push(t),w.nodeCache.push(t)),t.level<w.level){var r=T.cubeResolution*Math.pow(2,t.level-T.maxLevel),s=Math.ceil(r*T.invTileResolution)-1,l=r%T.tileResolution*2,c=2*r%T.tileResolution;0===c&&(c=T.tileResolution),0===l&&(l=2*T.tileResolution),h=.5,t.x!=s&&t.y!=s||(h=1-T.tileResolution/(T.tileResolution+c));var f=1-h,r=[],m=h,p=h,v=h,y=f,x=f,b=f;for(c<T.tileResolution&&(t.x==s&&t.y!=s?(x=p=.5,("d"==t.side||"u"==t.side)&&(b=v=.5)):t.x!=s&&t.y==s&&(y=m=.5,"l"==t.side||"r"==t.side)&&(b=v=.5)),l<=T.tileResolution&&(t.x==s&&(m=0,y=1,"l"==t.side||"r"==t.side)&&(v=0,b=1),t.y==s&&(p=0,x=1,"d"==t.side||"u"==t.side)&&(v=0,b=1)),c=[i[0],i[1],i[2],i[0]*m+i[3]*y,i[1]*h+i[4]*f,i[2]*v+i[5]*b,i[0]*m+i[6]*y,i[1]*p+i[7]*x,i[2]*v+i[8]*b,i[0]*h+i[9]*f,i[1]*p+i[10]*x,i[2]*v+i[11]*b],c=new u(c,t.side,t.level+1,2*t.x,2*t.y,T.fullpath),r.push(c),t.x==s&&l<=T.tileResolution||(c=[i[0]*m+i[3]*y,i[1]*h+i[4]*f,i[2]*v+i[5]*b,i[3],i[4],i[5],i[3]*h+i[6]*f,i[4]*p+i[7]*x,i[5]*v+i[8]*b,i[0]*m+i[6]*y,i[1]*p+i[7]*x,i[2]*v+i[8]*b],c=new u(c,t.side,t.level+1,2*t.x+1,2*t.y,T.fullpath),r.push(c)),t.x==s&&l<=T.tileResolution||t.y==s&&l<=T.tileResolution||(c=[i[0]*m+i[6]*y,i[1]*p+i[7]*x,i[2]*v+i[8]*b,i[3]*h+i[6]*f,i[4]*p+i[7]*x,i[5]*v+i[8]*b,i[6],i[7],i[8],i[9]*m+i[6]*y,i[10]*h+i[7]*f,i[11]*v+i[8]*b],c=new u(c,t.side,t.level+1,2*t.x+1,2*t.y+1,T.fullpath),r.push(c)),t.y==s&&l<=T.tileResolution||(c=[i[0]*h+i[9]*f,i[1]*p+i[10]*x,i[2]*v+i[11]*b,i[0]*m+i[6]*y,i[1]*p+i[7]*x,i[2]*v+i[8]*b,i[9]*m+i[6]*y,i[10]*h+i[7]*f,i[11]*v+i[8]*b,i[9],i[10],i[11]],c=new u(c,t.side,t.level+1,2*t.x,2*t.y+1,T.fullpath),r.push(c)),t=0;t<r.length;t++)d(e,r[t],a,o,n)}}}function f(){return[-1,1,-1,1,1,-1,1,-1,-1,-1,-1,-1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,-1,1,1,1,1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,-1,-1,-1,1,1,1,-1,1,1,1,1,-1,1,1,-1,-1]}function m(e,t,a){var o=Math.sin(t);return t=Math.cos(t),"x"==a?[e[0],t*e[1]+o*e[2],t*e[2]-o*e[1],e[3],t*e[4]+o*e[5],t*e[5]-o*e[4],e[6],t*e[7]+o*e[8],t*e[8]-o*e[7]]:"y"==a?[t*e[0]-o*e[2],e[1],t*e[2]+o*e[0],t*e[3]-o*e[5],e[4],t*e[5]+o*e[3],t*e[6]-o*e[8],e[7],t*e[8]+o*e[6]]:"z"==a?[t*e[0]+o*e[1],t*e[1]-o*e[0],e[2],t*e[3]+o*e[4],t*e[4]-o*e[3],e[5],t*e[6]+o*e[7],t*e[7]-o*e[6],e[8]]:void 0}function p(e){return[e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15]]}function v(e){e.textureLoad||(e.textureLoad=!0,N(encodeURI(e.path+"."+T.extension),function(t){e.texture=t,e.textureLoaded=!0}))}function g(e,t){var a=[e[0]*t[0]+e[1]*t[1]+e[2]*t[2],e[4]*t[0]+e[5]*t[1]+e[6]*t[2],e[11]+e[8]*t[0]+e[9]*t[1]+e[10]*t[2],1/(e[12]*t[0]+e[13]*t[1]+e[14]*t[2])],o=a[0]*a[3],n=a[1]*a[3],a=a[2]*a[3],i=[0,0,0];return-1>o&&(i[0]=-1),1<o&&(i[0]=1),-1>n&&(i[1]=-1),1<n&&(i[1]=1),(-1>a||1<a)&&(i[2]=1),i}var y=t.createElement("canvas");y.style.width=y.style.height="100%",o.appendChild(y);var w,x,b,E,M,P,R,_,T,L,I,C,A,D,S;this.init=function(e,h,c,u,d,m,p,v){if(typeof h===a&&(h="equirectangular"),L=h,T=e,I=c,w){if(b&&(x.detachShader(w,b),x.deleteShader(b)),E&&(x.detachShader(w,E),x.deleteShader(E)),x.bindBuffer(x.ARRAY_BUFFER,null),x.bindBuffer(x.ELEMENT_ARRAY_BUFFER,null),w.texture&&x.deleteTexture(w.texture),w.nodeCache)for(e=0;e<w.nodeCache.length;e++)x.deleteTexture(w.nodeCache[e].texture);x.deleteProgram(w),w=a}if(_=a,"cubemap"==L&&0!=(T[0].width&T[0].width-1)&&(navigator.userAgent.toLowerCase().match(/(iphone|ipod|ipad).* os 8_/)||navigator.userAgent.toLowerCase().match(/(iphone|ipod|ipad).* os 9_/)||navigator.userAgent.match(/Trident.*rv[ :]*11\./))||x||(x=y.getContext("experimental-webgl",{alpha:!1,depth:!1})),!x&&("multires"==L&&T.hasOwnProperty("fallbackPath")||"cubemap"==L)&&("WebkitAppearance"in t.documentElement.style||navigator.userAgent.match(/Trident.*rv[ :]*11\./)||-1!==navigator.appVersion.indexOf("MSIE 10"))){P&&o.removeChild(P),P=t.createElement("div"),P.className="pnlm-world",u=T.basePath?T.basePath+T.fallbackPath:T.fallbackPath;var g="frblud".split(""),N=0;for(d=function(){var e=t.createElement("canvas");e.className="pnlm-face pnlm-"+g[this.side]+"face",P.appendChild(e);var a=e.getContext("2d");e.style.width=this.width+4+"px",e.style.height=this.height+4+"px",e.width=this.width+4,e.height=this.height+4,a.drawImage(this,2,2);var n,i,r=a.getImageData(0,0,e.width,e.height),s=r.data;for(n=2;n<e.width-2;n++)for(i=0;4>i;i++)s[4*(n+e.width)+i]=s[4*(n+2*e.width)+i],s[4*(n+e.width*(e.height-2))+i]=s[4*(n+e.width*(e.height-3))+i];for(n=2;n<e.height-2;n++)for(i=0;4>i;i++)s[4*(n*e.width+1)+i]=s[4*(n*e.width+2)+i],s[4*((n+1)*e.width-2)+i]=s[4*((n+1)*e.width-3)+i];for(i=0;4>i;i++)s[4*(e.width+1)+i]=s[4*(2*e.width+2)+i],s[4*(2*e.width-2)+i]=s[4*(3*e.width-3)+i],s[4*(e.width*(e.height-2)+1)+i]=s[4*(e.width*(e.height-3)+2)+i],s[4*(e.width*(e.height-1)-2)+i]=s[4*(e.width*(e.height-2)-3)+i];for(n=1;n<e.width-1;n++)for(i=0;4>i;i++)s[4*n+i]=s[4*(n+e.width)+i],s[4*(n+e.width*(e.height-1))+i]=s[4*(n+e.width*(e.height-2))+i];for(n=1;n<e.height-1;n++)for(i=0;4>i;i++)s[n*e.width*4+i]=s[4*(n*e.width+1)+i],s[4*((n+1)*e.width-1)+i]=s[4*((n+1)*e.width-2)+i];for(i=0;4>i;i++)s[i]=s[4*(e.width+1)+i],s[4*(e.width-1)+i]=s[4*(2*e.width-2)+i],s[e.width*(e.height-1)*4+i]=s[4*(e.width*(e.height-2)+1)+i],s[4*(e.width*e.height-1)+i]=s[4*(e.width*(e.height-1)-2)+i];a.putImageData(r,0,0),6==++N&&(M=this.width,o.appendChild(P),p())},e=0;6>e;e++)m=new Image,m.crossOrigin="anonymous",m.side=e,m.onload=d,m.src="multires"==L?encodeURI(u.replace("%s",g[e])+"."+T.extension):encodeURI(T[e].src)}else{if(!x)throw console.log("Error: no WebGL support detected!"),{type:"no webgl"};for(T.fullpath=T.basePath?T.basePath+T.path:T.path,T.invTileResolution=1/T.tileResolution,h=f(),R=[],e=0;6>e;e++)R[e]=h.slice(12*e,12*e+12),h=f();if("equirectangular"==L){if(e=Math.max(T.width,T.height),h=x.getParameter(x.MAX_TEXTURE_SIZE),e>h)throw console.log("Error: The image is too big; it's "+e+"px wide, but this device's maximum supported width is "+h+"px."),{type:"webgl size error",width:e,maxWidth:h}}else if("cubemap"==L&&(e=T[0].width,h=x.getParameter(x.MAX_CUBE_MAP_TEXTURE_SIZE),e>h))throw console.log("Error: The cube face image is too big; it's "+e+"px wide, but this device's maximum supported width is "+h+"px."),{type:"webgl size error",width:e,maxWidth:h};if(v===a||v.horizonPitch===a&&v.horizonRoll===a||(_=[v.horizonPitch==a?0:v.horizonPitch,v.horizonRoll==a?0:v.horizonRoll]),e=x.TEXTURE_2D,x.viewport(0,0,y.width,y.height),b=x.createShader(x.VERTEX_SHADER),h=n,"multires"==L&&(h=i),x.shaderSource(b,h),x.compileShader(b),E=x.createShader(x.FRAGMENT_SHADER),h=s,"cubemap"==L?(e=x.TEXTURE_CUBE_MAP,h=r):"multires"==L&&(h=l),x.shaderSource(E,h),x.compileShader(E),w=x.createProgram(),x.attachShader(w,b),x.attachShader(w,E),x.linkProgram(w),x.getShaderParameter(b,x.COMPILE_STATUS)||console.log(x.getShaderInfoLog(b)),x.getShaderParameter(E,x.COMPILE_STATUS)||console.log(x.getShaderInfoLog(E)),x.getProgramParameter(w,x.LINK_STATUS)||console.log(x.getProgramInfoLog(w)),x.useProgram(w),w.drawInProgress=!1,w.texCoordLocation=x.getAttribLocation(w,"a_texCoord"),x.enableVertexAttribArray(w.texCoordLocation),"multires"!=L?(C||(C=x.createBuffer()),x.bindBuffer(x.ARRAY_BUFFER,C),x.bufferData(x.ARRAY_BUFFER,new Float32Array([-1,1,1,1,1,-1,-1,1,1,-1,-1,-1]),x.STATIC_DRAW),x.vertexAttribPointer(w.texCoordLocation,2,x.FLOAT,!1,0,0),w.aspectRatio=x.getUniformLocation(w,"u_aspectRatio"),x.uniform1f(w.aspectRatio,y.width/y.height),w.psi=x.getUniformLocation(w,"u_psi"),w.theta=x.getUniformLocation(w,"u_theta"),w.f=x.getUniformLocation(w,"u_f"),w.h=x.getUniformLocation(w,"u_h"),w.v=x.getUniformLocation(w,"u_v"),w.vo=x.getUniformLocation(w,"u_vo"),w.rot=x.getUniformLocation(w,"u_rot"),x.uniform1f(w.h,u/(2*Math.PI)),x.uniform1f(w.v,d/Math.PI),x.uniform1f(w.vo,m/Math.PI*2),"equirectangular"==L&&(w.backgroundColor=x.getUniformLocation(w,"u_backgroundColor"),x.uniform4fv(w.backgroundColor,(v.backgroundColor?v.backgroundColor:[0,0,0]).concat([1]))),w.texture=x.createTexture(),x.bindTexture(e,w.texture),"cubemap"==L?(x.texImage2D(x.TEXTURE_CUBE_MAP_POSITIVE_X,0,x.RGB,x.RGB,x.UNSIGNED_BYTE,T[1]),x.texImage2D(x.TEXTURE_CUBE_MAP_NEGATIVE_X,0,x.RGB,x.RGB,x.UNSIGNED_BYTE,T[3]),x.texImage2D(x.TEXTURE_CUBE_MAP_POSITIVE_Y,0,x.RGB,x.RGB,x.UNSIGNED_BYTE,T[4]),x.texImage2D(x.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,x.RGB,x.RGB,x.UNSIGNED_BYTE,T[5]),x.texImage2D(x.TEXTURE_CUBE_MAP_POSITIVE_Z,0,x.RGB,x.RGB,x.UNSIGNED_BYTE,T[0]),x.texImage2D(x.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,x.RGB,x.RGB,x.UNSIGNED_BYTE,T[2])):x.texImage2D(e,0,x.RGB,x.RGB,x.UNSIGNED_BYTE,T),x.texParameteri(e,x.TEXTURE_WRAP_S,x.CLAMP_TO_EDGE),x.texParameteri(e,x.TEXTURE_WRAP_T,x.CLAMP_TO_EDGE),x.texParameteri(e,x.TEXTURE_MIN_FILTER,x.LINEAR),x.texParameteri(e,x.TEXTURE_MAG_FILTER,x.LINEAR)):(w.vertPosLocation=x.getAttribLocation(w,"a_vertCoord"),x.enableVertexAttribArray(w.vertPosLocation),A||(A=x.createBuffer()),D||(D=x.createBuffer()),S||(S=x.createBuffer()),x.bindBuffer(x.ARRAY_BUFFER,D),x.bufferData(x.ARRAY_BUFFER,new Float32Array([0,0,1,0,1,1,0,1]),x.STATIC_DRAW),x.bindBuffer(x.ELEMENT_ARRAY_BUFFER,S),x.bufferData(x.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,0,2,3]),x.STATIC_DRAW),w.perspUniform=x.getUniformLocation(w,"u_perspMatrix"),w.cubeUniform=x.getUniformLocation(w,"u_cubeMatrix"),w.level=-1,w.currentNodes=[],w.nodeCache=[],w.nodeCacheTimestamp=0),0!==x.getError())throw console.log("Error: Something went wrong with WebGL!"),{type:"webgl error"};p()}},this.destroy=function(){if(o!==a&&(y!==a&&o.removeChild(y),P!==a&&o.removeChild(P)),x){var e=x.getExtension("WEBGL_lose_context");e&&e.loseContext()}},this.resize=function(){var t=e.devicePixelRatio||1;y.width=y.clientWidth*t,y.height=y.clientHeight*t,x&&(x.viewport(0,0,y.width,y.height),"multires"!=L&&x.uniform1f(w.aspectRatio,y.width/y.height))},this.resize(),this.render=function(t,o,n,i){var r;if(r=0,i===a&&(i={}),i.roll&&(r=i.roll),_!==a){var s=_[0],l=_[1],f=t,g=o,b=Math.cos(l)*Math.sin(t)*Math.sin(s)+Math.cos(t)*(Math.cos(s)*Math.cos(o)+Math.sin(l)*Math.sin(s)*Math.sin(o)),E=-Math.sin(t)*Math.sin(l)+Math.cos(t)*Math.cos(l)*Math.sin(o);t=Math.cos(l)*Math.cos(s)*Math.sin(t)+Math.cos(t)*(-Math.cos(o)*Math.sin(s)+Math.cos(s)*Math.sin(l)*Math.sin(o)),t=Math.asin(Math.max(Math.min(t,1),-1)),o=Math.atan2(E,b),s=[Math.cos(f)*(Math.sin(l)*Math.sin(s)*Math.cos(g)-Math.cos(s)*Math.sin(g)),Math.cos(f)*Math.cos(l)*Math.cos(g),Math.cos(f)*(Math.cos(s)*Math.sin(l)*Math.cos(g)+Math.sin(g)*Math.sin(s))],l=[-Math.cos(t)*Math.sin(o),Math.cos(t)*Math.cos(o)],l=Math.acos(Math.max(Math.min((s[0]*l[0]+s[1]*l[1])/(Math.sqrt(s[0]*s[0]+s[1]*s[1]+s[2]*s[2])*Math.sqrt(l[0]*l[0]+l[1]*l[1])),1),-1)),0>s[2]&&(l=2*Math.PI-l),r+=l}if(x||"multires"!=L&&"cubemap"!=L){if("multires"!=L)n=2*Math.atan(Math.tan(.5*n)/(y.width/y.height)),n=1/Math.tan(.5*n),x.uniform1f(w.psi,o),x.uniform1f(w.theta,t),x.uniform1f(w.rot,r),x.uniform1f(w.f,n),!0===I&&"equirectangular"==L&&(x.bindTexture(x.TEXTURE_2D,w.texture),x.texImage2D(x.TEXTURE_2D,0,x.RGB,x.RGB,x.UNSIGNED_BYTE,T)),x.drawArrays(x.TRIANGLES,0,6);else{for(s=y.width/y.height,l=2*Math.atan(Math.tan(n/2)*y.height/y.width),l=1/Math.tan(l/2),s=[l/s,0,0,0,0,l,0,0,0,0,100.1/-99.9,20/-99.9,0,0,-1,0],l=1;l<T.maxLevel&&y.width>T.tileResolution*Math.pow(2,l-1)*Math.tan(n/2)*.707;)l++;if(w.level=l,l=[1,0,0,0,1,0,0,0,1],l=m(l,-r,"z"),l=m(l,-t,"x"),l=m(l,o,"y"),l=[l[0],l[1],l[2],0,l[3],l[4],l[5],0,l[6],l[7],l[8],0,0,0,0,1],x.uniformMatrix4fv(w.perspUniform,!1,new Float32Array(p(s))),x.uniformMatrix4fv(w.cubeUniform,!1,new Float32Array(p(l))),s=[s[0]*l[0],s[0]*l[1],s[0]*l[2],0,s[5]*l[4],s[5]*l[5],s[5]*l[6],0,s[10]*l[8],s[10]*l[9],s[10]*l[10],s[11],-l[8],-l[9],-l[10],0],w.nodeCache.sort(h),200<w.nodeCache.length&&w.nodeCache.length>w.currentNodes.length+50)for(l=w.nodeCache.splice(200,w.nodeCache.length-200),r=0;r<l.length;r++)x.deleteTexture(l[r].texture);for(w.currentNodes=[],l="fbudlr".split(""),r=0;6>r;r++)f=new u(R[r],l[r],1,0,0,T.fullpath),d(s,f,t,o,n);for(w.currentNodes.sort(c),r=0;r<w.currentNodes.length;r++)if(!w.currentNodes[r].texture){setTimeout(v(w.currentNodes[r]),0);break}if(!w.drawInProgress){for(w.drawInProgress=!0,t=0;t<w.currentNodes.length;t++)w.currentNodes[t].textureLoaded&&(x.bindBuffer(x.ARRAY_BUFFER,A),x.bufferData(x.ARRAY_BUFFER,new Float32Array(w.currentNodes[t].vertices),x.STATIC_DRAW),x.vertexAttribPointer(w.vertPosLocation,3,x.FLOAT,!1,0,0),x.bindBuffer(x.ARRAY_BUFFER,D),x.vertexAttribPointer(w.texCoordLocation,2,x.FLOAT,!1,0,0),x.bindTexture(x.TEXTURE_2D,w.currentNodes[t].texture),x.drawElements(x.TRIANGLES,6,x.UNSIGNED_SHORT,0));w.drawInProgress=!1}}if(i.returnImage!==a)return y.toDataURL("image/png")}else for(r=M/2,i={f:"translate3d(-"+(r+2)+"px, -"+(r+2)+"px, -"+r+"px)",b:"translate3d("+(r+2)+"px, -"+(r+2)+"px, "+r+"px) rotateX(180deg) rotateZ(180deg)",u:"translate3d(-"+(r+2)+"px, -"+r+"px, "+(r+2)+"px) rotateX(270deg)",d:"translate3d(-"+(r+2)+"px, "+r+"px, -"+(r+2)+"px) rotateX(90deg)",l:"translate3d(-"+r+"px, -"+(r+2)+"px, "+(r+2)+"px) rotateX(180deg) rotateY(90deg) rotateZ(180deg)",r:"translate3d("+r+"px, -"+(r+2)+"px, -"+(r+2)+"px) rotateY(270deg)"},n=1/Math.tan(n/2),n=n*y.width/(e.devicePixelRatio||1)/2+"px",t="perspective("+n+") translateZ("+n+") rotateX("+t+"rad) rotateY("+o+"rad) ",o=Object.keys(i),r=0;6>r;r++)n=P.querySelector(".pnlm-"+o[r]+"face").style,n.webkitTransform=t+i[o[r]],n.transform=t+i[o[r]]},this.isLoading=function(){if(x&&"multires"==L)for(var e=0;e<w.currentNodes.length;e++)if(!w.currentNodes[e].textureLoaded)return!0;return!1},this.getCanvas=function(){return y};var N=function(){function e(){var e=this;this.texture=this.callback=null,this.image=new Image,this.image.crossOrigin="anonymous",this.image.addEventListener("load",function(){var t=e.image;x.bindTexture(x.TEXTURE_2D,e.texture),x.texImage2D(x.TEXTURE_2D,0,x.RGB,x.RGB,x.UNSIGNED_BYTE,t),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MAG_FILTER,x.LINEAR),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MIN_FILTER,x.LINEAR),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,x.CLAMP_TO_EDGE),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,x.CLAMP_TO_EDGE),x.bindTexture(x.TEXTURE_2D,null),e.callback(e.texture),n.length?(t=n.shift(),e.loadTexture(t.src,t.texture,t.callback)):o[a++]=e})}function t(e,t,a){this.src=e,this.texture=t,this.callback=a}var a=4,o={},n=[];e.prototype.loadTexture=function(e,t,a){this.texture=t,this.callback=a,this.image.src=e};for(var i=0;i<a;i++)o[i]=new e;return function(e,i){var r=x.createTexture();return a?o[--a].loadTexture(e,r,i):n.push(new t(e,r,i)),r}}()}var n="attribute vec2 a_texCoord;varying vec2 v_texCoord;void main() {gl_Position = vec4(a_texCoord, 0.0, 1.0);v_texCoord = a_texCoord;}",i="attribute vec3 a_vertCoord;attribute vec2 a_texCoord;uniform mat4 u_cubeMatrix;uniform mat4 u_perspMatrix;varying mediump vec2 v_texCoord;void main(void) {gl_Position = u_perspMatrix * u_cubeMatrix * vec4(a_vertCoord, 1.0);v_texCoord = a_texCoord;}",r="precision mediump float;\nuniform float u_aspectRatio;\nuniform float u_psi;\nuniform float u_theta;\nuniform float u_f;\nuniform float u_h;\nuniform float u_v;\nuniform float u_vo;\nuniform float u_rot;\nconst float PI = 3.14159265358979323846264;\nuniform sampler2D u_image;\nuniform samplerCube u_imageCube;\nvarying vec2 v_texCoord;\nuniform vec4 u_backgroundColor;\nvoid main() {\nfloat x = v_texCoord.x * u_aspectRatio;\nfloat y = v_texCoord.y;\nfloat sinrot = sin(u_rot);\nfloat cosrot = cos(u_rot);\nfloat rot_x = x * cosrot - y * sinrot;\nfloat rot_y = x * sinrot + y * cosrot;\nfloat sintheta = sin(u_theta);\nfloat costheta = cos(u_theta);\nfloat a = u_f * costheta - rot_y * sintheta;\nfloat root = sqrt(rot_x * rot_x + a * a);\nfloat lambda = atan(rot_x / root, a / root) + u_psi;\nfloat phi = atan((rot_y * costheta + u_f * sintheta) / root);float cosphi = cos(phi);\ngl_FragColor = textureCube(u_imageCube, vec3(cosphi*sin(lambda), sin(phi), cosphi*cos(lambda)));\n}",s="precision mediump float;\nuniform float u_aspectRatio;\nuniform float u_psi;\nuniform float u_theta;\nuniform float u_f;\nuniform float u_h;\nuniform float u_v;\nuniform float u_vo;\nuniform float u_rot;\nconst float PI = 3.14159265358979323846264;\nuniform sampler2D u_image;\nuniform samplerCube u_imageCube;\nvarying vec2 v_texCoord;\nuniform vec4 u_backgroundColor;\nvoid main() {\nfloat x = v_texCoord.x * u_aspectRatio;\nfloat y = v_texCoord.y;\nfloat sinrot = sin(u_rot);\nfloat cosrot = cos(u_rot);\nfloat rot_x = x * cosrot - y * sinrot;\nfloat rot_y = x * sinrot + y * cosrot;\nfloat sintheta = sin(u_theta);\nfloat costheta = cos(u_theta);\nfloat a = u_f * costheta - rot_y * sintheta;\nfloat root = sqrt(rot_x * rot_x + a * a);\nfloat lambda = atan(rot_x / root, a / root) + u_psi;\nfloat phi = atan((rot_y * costheta + u_f * sintheta) / root);lambda = mod(lambda + PI, PI * 2.0) - PI;\nvec2 coord = vec2(lambda / PI, phi / (PI / 2.0));\nif(coord.x < -u_h || coord.x > u_h || coord.y < -u_v + u_vo || coord.y > u_v + u_vo)\ngl_FragColor = u_backgroundColor;\nelse\ngl_FragColor = texture2D(u_image, vec2((coord.x + u_h) / (u_h * 2.0), (-coord.y + u_v + u_vo) / (u_v * 2.0)));\n}",l="varying mediump vec2 v_texCoord;uniform sampler2D u_sampler;void main(void) {gl_FragColor = texture2D(u_sampler, v_texCoord);}";return{renderer:function(e,t,a,n){return new o(e,t,a,n)}}}(window,document),window.requestAnimationFrame||(window.requestAnimationFrame=function(){return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,t){window.setTimeout(e,1e3/60)}}()),window.pannellum=function(e,t,a){function o(o,n){function i(){var n=t.createElement("div");if(n.innerHTML="\x3c!--[if lte IE 9]><i></i><![endif]--\x3e",1==n.getElementsByTagName("i").length)h();else{re=ee.hfov,se=ee.pitch;var i;if("cubemap"==ee.type){for(oe=[],n=0;6>n;n++)oe.push(new Image),oe[n].crossOrigin="anonymous";Ne.load.lbox.style.display="block",Ne.load.lbar.style.display="none"}else if("multires"==ee.type)n=JSON.parse(JSON.stringify(ee.multiRes)),ee.basePath&&ee.multiRes.basePath&&!/^(?:[a-z]+:)?\/\//i.test(ee.multiRes.basePath)?n.basePath=ee.basePath+ee.multiRes.basePath:ee.multiRes.basePath?n.basePath=ee.multiRes.basePath:ee.basePath&&(n.basePath=ee.basePath),oe=n;else if(!0===ee.dynamic)oe=ee.panorama;else{if(ee.panorama===a)return void h("No panorama image was specified.");oe=new Image}if("cubemap"==ee.type)for(var c=6,u=function(){0===--c&&s()},d=function(e){var a=t.createElement("a");a.href=e.target.src,a.innerHTML=a.href,h("The file "+a.outerHTML+" could not be accessed.")},n=0;n<oe.length;n++)oe[n].onload=u,oe[n].onerror=d,i=ee.cubeMap[n],ee.basePath&&!r(i)&&(i=ee.basePath+i),oe[n].src=encodeURI(i);else if("multires"==ee.type)s();else if(i="",ee.basePath&&(i=ee.basePath),!0!==ee.dynamic){i=r(ee.panorama)?ee.panorama:i+ee.panorama,oe.onload=function(){e.URL.revokeObjectURL(this.src),s()};var f=new XMLHttpRequest;f.onloadend=function(){if(200!=f.status){var e=t.createElement("a");e.href=encodeURI(i),e.innerHTML=e.href,h("The file "+e.outerHTML+" could not be accessed.")}l(this.response),Ne.load.msg.innerHTML=""},f.onprogress=function(e){if(e.lengthComputable){Ne.load.lbarFill.style.width=e.loaded/e.total*100+"%";var t,a;1e6<e.total?(t="MB",a=(e.loaded/1e6).toFixed(2),e=(e.total/1e6).toFixed(2)):1e3<e.total?(t="kB",a=(e.loaded/1e3).toFixed(1),e=(e.total/1e3).toFixed(1)):(t="B",a=e.loaded,e=e.total),Ne.load.msg.innerHTML=a+" / "+e+" "+t}else Ne.load.lbox.style.display="block",Ne.load.lbar.style.display="none"};try{f.open("GET",i,!0)}catch(e){h("There is something wrong with the panorama URL.")}f.responseType="blob",f.setRequestHeader("Accept","image/*,*/*;q=0.9"),f.send()}o.classList.add("pnlm-grab"),o.classList.remove("pnlm-grabbing")}}function r(e){return/^(?:[a-z]+:)?\/\//i.test(e)||"/"==e[0]||"blob:"==e.slice(0,5)}function s(){te||(te=new libpannellum.renderer(Ae)),xe||(xe=!0,De.addEventListener("mousedown",d,!1),t.addEventListener("mousemove",m,!1),t.addEventListener("mouseup",p,!1),ee.mouseZoom&&(o.addEventListener("mousewheel",E,!1),o.addEventListener("DOMMouseScroll",E,!1)),o.addEventListener("mozfullscreenchange",X,!1),o.addEventListener("webkitfullscreenchange",X,!1),o.addEventListener("msfullscreenchange",X,!1),o.addEventListener("fullscreenchange",X,!1),e.addEventListener("resize",I,!1),e.addEventListener("orientationchange",I,!1),o.addEventListener("keydown",M,!1),o.addEventListener("keyup",R,!1),o.addEventListener("blur",P,!1),t.addEventListener("mouseleave",p,!1),De.addEventListener("touchstart",v,!1),De.addEventListener("touchmove",g,!1),De.addEventListener("touchend",y,!1),De.addEventListener("pointerdown",w,!1),De.addEventListener("pointermove",x,!1),De.addEventListener("pointerup",b,!1),De.addEventListener("pointerleave",b,!1),e.navigator.pointerEnabled&&(o.style.touchAction="none")),k(),setTimeout(function(){},500)}function l(t){var o=new FileReader;o.addEventListener("loadend",function(){var n=o.result;if(navigator.userAgent.toLowerCase().match(/(iphone|ipod|ipad).* os 8_/)){var i=n.indexOf("ÿÂ");(0>i||65536<i)&&h("Due to iOS 8's broken WebGL implementation, only progressive encoded JPEGs work for your device (this panorama uses standard encoding).")}if(-1<(i=n.indexOf("<x:xmpmeta"))&&!0!==ee.ignoreGPanoXMP){var r=n.substring(i,n.indexOf("</x:xmpmeta>")+12),s=function(e){var t;return 0<=r.indexOf(e+'="')?(t=r.substring(r.indexOf(e+'="')+e.length+2),t=t.substring(0,t.indexOf('"'))):0<=r.indexOf(e+">")&&(t=r.substring(r.indexOf(e+">")+e.length+1),t=t.substring(0,t.indexOf("<"))),t!==a?Number(t):null},n=s("GPano:FullPanoWidthPixels"),i=s("GPano:CroppedAreaImageWidthPixels"),l=s("GPano:FullPanoHeightPixels"),c=s("GPano:CroppedAreaImageHeightPixels"),u=s("GPano:CroppedAreaTopPixels"),d=s("GPano:PoseHeadingDegrees"),f=s("GPano:PosePitchDegrees"),s=s("GPano:PoseRollDegrees");null!==n&&null!==i&&null!==l&&null!==c&&null!==u&&(0>Te.indexOf("haov")&&(ee.haov=i/n*360),0>Te.indexOf("vaov")&&(ee.vaov=c/l*180),0>Te.indexOf("vOffset")&&(ee.vOffset=-180*((u+c/2)/l-.5)),null!==d&&0>Te.indexOf("northOffset")&&(ee.northOffset=d,!1!==ee.compass&&(ee.compass=!0)),null!==f&&null!==s&&(0>Te.indexOf("horizonPitch")&&(ee.horizonPitch=f),0>Te.indexOf("horizonRoll")&&(ee.horizonRoll=s)))}oe.src=e.URL.createObjectURL(t)}),o.readAsBinaryString!==a?o.readAsBinaryString(t):o.readAsText(t)}function h(e){e===a&&(e="Your browser does not have the necessary WebGL support to display this panorama."),Ne.errorMsg.innerHTML="<p>"+e+"</p>",Ue.load.style.display="none",Ne.load.box.style.display="none",Ne.errorMsg.style.display="table",we=!0,Ae.style.display="none",$("error",e)}function c(e){var t=u(e);Se.style.left=t.x+"px",Se.style.top=t.y+"px",clearTimeout(c.t1),clearTimeout(c.t2),Se.style.display="block",Se.style.opacity=1,c.t1=setTimeout(function(){Se.style.opacity=0},2e3),c.t2=setTimeout(function(){Se.style.display="none"},2500),e.preventDefault()}function u(e){var t=o.getBoundingClientRect(),a={};return a.x=e.clientX-t.left,a.y=e.clientY-t.top,a}function d(e){if(e.preventDefault(),o.focus(),ye){var t=u(e);if(ee.hotSpotDebug){var a=f(e);console.log("Pitch: "+a[0]+", Yaw: "+a[1]+", Center Pitch: "+ee.pitch+", Center Yaw: "+ee.yaw+", HFOV: "+ee.hfov)}Z(),J(),ee.roll=0,be.hfov=0,he=!0,ce=Date.now(),ue=t.x,de=t.y,me=ee.yaw,pe=ee.pitch,o.classList.add("pnlm-grabbing"),o.classList.remove("pnlm-grab"),$("mousedown",e),C()}}function f(t){var a=u(t);t=te.getCanvas();var o=t.width/(e.devicePixelRatio||1),n=t.height/(e.devicePixelRatio||1);t=a.x/o*2-1;var n=(1-a.y/n*2)*n/o,i=1/Math.tan(ee.hfov*Math.PI/360),r=Math.sin(ee.pitch*Math.PI/180),s=Math.cos(ee.pitch*Math.PI/180),a=i*s-n*r,o=Math.sqrt(t*t+a*a),n=180*Math.atan((n*s+i*r)/o)/Math.PI;return t=180*Math.atan2(t/o,a/o)/Math.PI+ee.yaw,[n,t]}function m(t){if(he&&ye){ce=Date.now();var a=te.getCanvas(),o=a.width/(e.devicePixelRatio||1),a=a.height/(e.devicePixelRatio||1);t=u(t);var n=180*(Math.atan(ue/o*2-1)-Math.atan(t.x/o*2-1))/Math.PI*ee.hfov/90+me;be.yaw=(n-ee.yaw)%360*.2,ee.yaw=n,o=360*Math.atan(Math.tan(ee.hfov/360*Math.PI)*a/o)/Math.PI,o=180*(Math.atan(t.y/a*2-1)-Math.atan(de/a*2-1))/Math.PI*o/90+pe,be.pitch=.2*(o-ee.pitch),ee.pitch=o}}function p(e){he&&(he=!1,15<Date.now()-ce&&(be.pitch=be.yaw=0),o.classList.add("pnlm-grab"),o.classList.remove("pnlm-grabbing"),ce=Date.now(),$("mouseup",e))}function v(e){if(ye){Z(),J(),ee.roll=0,be.hfov=0;var t=u(e.targetTouches[0]);ue=t.x,de=t.y,2==e.targetTouches.length&&(e=u(e.targetTouches[1]),ue+=.5*(e.x-t.x),de+=.5*(e.y-t.y),fe=Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))),he=!0,ce=Date.now(),me=ee.yaw,pe=ee.pitch,C()}}function g(e){if(e.preventDefault(),ye&&(ce=Date.now()),he&&ye){var t=u(e.targetTouches[0]),a=t.x,o=t.y;2==e.targetTouches.length&&-1!=fe&&(e=u(e.targetTouches[1]),a+=.5*(e.x-t.x),o+=.5*(e.y-t.y),t=Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y)),W(ee.hfov+.1*(fe-t)),fe=t),t=ee.hfov/360,a=(ue-a)*t+me,be.yaw=(a-ee.yaw)%360*.2,ee.yaw=a,o=(o-de)*t+pe,be.pitch=.2*(o-ee.pitch),ee.pitch=o}}function y(){he=!1,150<Date.now()-ce&&(be.pitch=be.yaw=0),fe=-1,ce=Date.now()}function w(e){"touch"==e.pointerType&&(Oe.push(e.pointerId),ze.push({clientX:e.clientX,clientY:e.clientY}),e.targetTouches=ze,v(e),e.preventDefault())}function x(e){if("touch"==e.pointerType)for(var t=0;t<Oe.length;t++)if(e.pointerId==Oe[t]){ze[t]={clientX:e.clientX,clientY:e.clientY},e.targetTouches=ze,g(e);break}}function b(e){if("touch"==e.pointerType){for(var t=!1,o=0;o<Oe.length;o++)e.pointerId==Oe[o]&&(Oe[o]=a),Oe[o]&&(t=!0);t||(Oe=[],ze=[],y()),e.preventDefault()}}function E(e){e.preventDefault(),ye&&(Z(),ce=Date.now(),e.wheelDeltaY?(W(ee.hfov-.05*e.wheelDeltaY),be.hfov=0>e.wheelDelta?1:-1):e.wheelDelta?(W(ee.hfov-.05*e.wheelDelta),be.hfov=0>e.wheelDelta?1:-1):e.detail&&(W(ee.hfov+1.5*e.detail),be.hfov=0<e.detail?1:-1),C())}function M(e){e.preventDefault(),Z(),ce=Date.now(),J(),ee.roll=0;var t=e.keycode;e.which&&(t=e.which),27==t?ge&&Y():_(t,!0)}function P(){for(var e=0;10>e;e++)ve[e]=!1}function R(e){e.preventDefault();var t=e.keycode;e.which&&(t=e.which),_(t,!1)}function _(e,t){var a=!1;switch(e){case 109:case 189:case 17:ve[0]!=t&&(a=!0),ve[0]=t;break;case 107:case 187:case 16:ve[1]!=t&&(a=!0),ve[1]=t;break;case 38:ve[2]!=t&&(a=!0),ve[2]=t;break;case 87:ve[6]!=t&&(a=!0),ve[6]=t;break;case 40:ve[3]!=t&&(a=!0),ve[3]=t;break;case 83:ve[7]!=t&&(a=!0),ve[7]=t;break;case 37:ve[4]!=t&&(a=!0),ve[4]=t;break;case 65:ve[8]!=t&&(a=!0),ve[8]=t;break;case 39:ve[5]!=t&&(a=!0),ve[5]=t;break;case 68:ve[9]!=t&&(a=!0),ve[9]=t}a&&t&&(ne="undefined"!=typeof performance&&performance.now()?performance.now():Date.now(),C())}function T(){if(ye){var e,t=!1,o=ee.pitch,n=ee.yaw,i=ee.hfov;e="undefined"!=typeof performance&&performance.now()?performance.now():Date.now(),ne===a&&(ne=e);var r=(e-ne)*ee.hfov/1700,r=Math.min(r,1);if(ve[0]&&!0===ee.keyboardZoom&&(W(ee.hfov+(.8*be.hfov+.5)*r),t=!0),ve[1]&&!0===ee.keyboardZoom&&(W(ee.hfov+(.8*be.hfov-.2)*r),t=!0),(ve[2]||ve[6])&&(ee.pitch+=(.8*be.pitch+.2)*r,t=!0),(ve[3]||ve[7])&&(ee.pitch+=(.8*be.pitch-.2)*r,t=!0),(ve[4]||ve[8])&&(ee.yaw+=(.8*be.yaw-.2)*r,t=!0),(ve[5]||ve[9])&&(ee.yaw+=(.8*be.yaw+.2)*r,t=!0),t&&(ce=Date.now()),Date.now(),ee.autoRotate){if(.001<e-ne){var t=(e-ne)/1e3,s=(be.yaw/t*r-.2*ee.autoRotate)*t,s=(0<-ee.autoRotate?1:-1)*Math.min(Math.abs(ee.autoRotate*t),Math.abs(s));ee.yaw+=s}ee.autoRotateStopDelay&&(ee.autoRotateStopDelay-=e-ne,0>=ee.autoRotateStopDelay&&(ee.autoRotateStopDelay=!1,Pe=ee.autoRotate,ee.autoRotate=0))}Re.pitch&&(L("pitch"),o=ee.pitch),Re.yaw&&(L("yaw"),n=ee.yaw),Re.hfov&&(L("hfov"),i=ee.hfov),0<r&&!ee.autoRotate&&(ve[4]||ve[5]||ve[8]||ve[9]||Re.yaw||(ee.yaw+=be.yaw*r*.85),ve[2]||ve[3]||ve[6]||ve[7]||Re.pitch||(ee.pitch+=be.pitch*r*.85),ve[0]||ve[1]||Re.hfov||W(ee.hfov+be.hfov*r*.85)),ne=e,0<r&&(be.yaw=.8*be.yaw+(ee.yaw-n)/r*.2,be.pitch=.8*be.pitch+(ee.pitch-o)/r*.2,be.hfov=.8*be.hfov+(ee.hfov-i)/r*.2,o=ee.autoRotate?Math.abs(ee.autoRotate):5,be.yaw=Math.min(o,Math.max(be.yaw,-o)),be.pitch=Math.min(o,Math.max(be.pitch,-o)),be.hfov=Math.min(o,Math.max(be.hfov,-o))),ve[0]&&ve[0]&&(be.hfov=0),(ve[2]||ve[6])&&(ve[3]||ve[7])&&(be.pitch=0),(ve[4]||ve[8])&&(ve[5]||ve[9])&&(be.yaw=0)}}function L(e){var t=Re[e],a=Math.min(1,Math.max((Date.now()-t.startTime)/1e3/(t.duration/1e3),0)),a=t.startPosition+(.5>a?2*a*a:(4-2*a)*a-1)*(t.endPosition-t.startPosition);(t.endPosition>t.startPosition&&a>=t.endPosition||t.endPosition<t.startPosition&&a<=t.endPosition)&&(a=t.endPosition,be[e]=0,delete Re[e]),ee[e]=a}function I(){X()}function C(){Ee||(Ee=!0,A())}function A(){if(D(),ie&&clearTimeout(ie),he||Me)requestAnimationFrame(A);else if(ve[0]||ve[1]||ve[2]||ve[3]||ve[4]||ve[5]||ve[6]||ve[7]||ve[8]||ve[9]||ee.autoRotate||Re.pitch||Re.yaw||Re.hfov||.01<Math.abs(be.yaw)||.01<Math.abs(be.pitch)||.01<Math.abs(be.hfov))T(),0<=ee.autoRotateInactivityDelay&&Pe&&Date.now()-ce>ee.autoRotateInactivityDelay&&!ee.autoRotate&&(ee.autoRotate=Pe,le.lookAt(se,a,re,3e3)),requestAnimationFrame(A);else if(te&&(te.isLoading()||!0===ee.dynamic&&Le))requestAnimationFrame(A);else{Ee=!1,ne=a;var e=ee.autoRotateInactivityDelay-(Date.now()-ce);0<e?ie=setTimeout(function(){ee.autoRotate=Pe,le.lookAt(se,a,re,3e3),C()},e):0<=ee.autoRotateInactivityDelay&&Pe&&(ee.autoRotate=Pe,le.lookAt(se,a,re,3e3),C())}}function D(){var e;if(ye){180<ee.yaw?ee.yaw-=360:-180>ee.yaw&&(ee.yaw+=360),e=ee.yaw;var t=ee.maxYaw-ee.minYaw,a=-180,o=180;360>t&&(a=ee.minYaw+ee.hfov/2,o=ee.maxYaw-ee.hfov/2,t<ee.hfov&&(a=o=(a+o)/2)),ee.yaw=Math.max(a,Math.min(o,ee.yaw)),!1!==ee.autoRotate&&e!=ee.yaw&&(ee.autoRotate*=-1),e=te.getCanvas(),e=2*Math.atan(Math.tan(ee.hfov/180*Math.PI*.5)/(e.width/e.height))/Math.PI*180,t=ee.minPitch+e/2,a=ee.maxPitch-e/2,ee.maxPitch-ee.minPitch<e&&(t=a=(t+a)/2),isNaN(t)&&(t=-90),isNaN(a)&&(a=90),ee.pitch=Math.max(t,Math.min(a,ee.pitch)),te.render(ee.pitch*Math.PI/180,ee.yaw*Math.PI/180,ee.hfov*Math.PI/180,{roll:ee.roll*Math.PI/180}),ee.hotSpots.forEach(B),ee.compass&&(Fe.style.transform="rotate("+(-ee.yaw-ee.northOffset)+"deg)",Fe.style.webkitTransform="rotate("+(-ee.yaw-ee.northOffset)+"deg)")}}function S(e,t,a,o){this.w=e,this.x=t,this.y=a,this.z=o}function N(t){var a;a=t.alpha;var o=t.beta;t=t.gamma,o=[o?o*Math.PI/180/2:0,t?t*Math.PI/180/2:0,a?a*Math.PI/180/2:0],a=[Math.cos(o[0]),Math.cos(o[1]),Math.cos(o[2])],o=[Math.sin(o[0]),Math.sin(o[1]),Math.sin(o[2])],a=new S(a[0]*a[1]*a[2]-o[0]*o[1]*o[2],o[0]*a[1]*a[2]-a[0]*o[1]*o[2],a[0]*o[1]*a[2]+o[0]*a[1]*o[2],a[0]*a[1]*o[2]+o[0]*o[1]*a[2]),a=a.multiply(new S(Math.sqrt(.5),-Math.sqrt(.5),0,0)),o=e.orientation?-e.orientation*Math.PI/180/2:0,a=a.multiply(new S(Math.cos(o),0,-Math.sin(o),0)).toEulerAngles(),ee.pitch=a[0]/Math.PI*180,ee.roll=-a[1]/Math.PI*180,ee.yaw=-a[2]/Math.PI*180+ee.northOffset}function k(){try{var e={};ee.horizonPitch!==a&&(e.horizonPitch=ee.horizonPitch*Math.PI/180),ee.horizonRoll!==a&&(e.horizonRoll=ee.horizonRoll*Math.PI/180),
ee.backgroundColor!==a&&(e.backgroundColor=ee.backgroundColor),te.init(oe,ee.type,ee.dynamic,ee.haov*Math.PI/180,ee.vaov*Math.PI/180,ee.vOffset*Math.PI/180,U,e),!0!==ee.dynamic&&(oe=a)}catch(e){if("webgl error"==e.type||"no webgl"==e.type)h();else{if("webgl size error"!=e.type)throw h("Unknown error. Check developer console."),e;h("This panorama is too big for your device! It's "+e.width+"px wide, but your device only supports images up to "+e.maxWidth+"px wide. Try another device. (If you're the author, try scaling down the image.)")}}}function U(){if(ee.sceneFadeDuration&&te.fadeImg!==a){te.fadeImg.style.opacity=0;var e=te.fadeImg;delete te.fadeImg,setTimeout(function(){Ae.removeChild(e)},ee.sceneFadeDuration)}Fe.style.display=ee.compass?"inline":"none",O(),Ne.load.box.style.display="none",ae!==a&&(Ae.removeChild(ae),ae=a),ye=!0,$("load"),C()}function F(e){e.pitch=Number(e.pitch)||0,e.yaw=Number(e.yaw)||0;var a=t.createElement("div");a.className="pnlm-hotspot-base",a.className=e.cssClass?a.className+" "+e.cssClass:a.className+" pnlm-hotspot pnlm-sprite pnlm-"+Q(e.type);var o=t.createElement("span");e.text&&(o.innerHTML=Q(e.text));var n;if(e.video){n=t.createElement("video");var i=e.video;ee.basePath&&!r(i)&&(i=ee.basePath+i),n.src=encodeURI(i),n.controls=!0,n.style.width=e.width+"px",Ae.appendChild(a),o.appendChild(n)}else if(e.image){i=e.image,ee.basePath&&!r(i)&&(i=ee.basePath+i),n=t.createElement("a"),n.href=encodeURI(e.URL?e.URL:i),n.target="_blank",o.appendChild(n);var s=t.createElement("img");s.src=encodeURI(i),s.style.width=e.width+"px",s.style.paddingTop="5px",Ae.appendChild(a),n.appendChild(s),o.style.maxWidth="initial"}else e.URL?(n=t.createElement("a"),n.href=encodeURI(e.URL),n.target="_blank",Ae.appendChild(n),a.style.cursor="pointer",o.style.cursor="pointer",n.appendChild(a)):(e.sceneId&&(a.onclick=function(){return j(e.sceneId,e.targetPitch,e.targetYaw,e.targetHfov),!1},a.ontouchend=function(){return j(e.sceneId,e.targetPitch,e.targetYaw,e.targetHfov),!1},a.style.cursor="pointer",o.style.cursor="pointer"),Ae.appendChild(a));e.createTooltipFunc?e.createTooltipFunc(a,e.createTooltipArgs):(e.text||e.video||e.image)&&(a.classList.add("pnlm-tooltip"),a.appendChild(o),o.style.width=o.scrollWidth-20+"px",o.style.marginLeft=-(o.scrollWidth-a.offsetWidth)/2+"px",o.style.marginTop=-o.scrollHeight-12+"px"),e.clickHandlerFunc&&(a.addEventListener("click",function(t){e.clickHandlerFunc(t,e.clickHandlerArgs)},"false"),a.style.cursor="pointer",o.style.cursor="pointer"),e.div=a}function O(){Ie||(ee.hotSpots?(ee.hotSpots=ee.hotSpots.sort(function(e,t){return e.pitch<t.pitch}),ee.hotSpots.forEach(F)):ee.hotSpots=[],Ie=!0,ee.hotSpots.forEach(B))}function z(){if(ee.hotSpots)for(var e=0;e<ee.hotSpots.length;e++){for(var t=ee.hotSpots[e].div;t.parentNode!=Ae;)t=t.parentNode;Ae.removeChild(t),delete ee.hotSpots[e].div}Ie=!1,delete ee.hotSpots}function B(t){var a=Math.sin(t.pitch*Math.PI/180),o=Math.cos(t.pitch*Math.PI/180),n=Math.sin(ee.pitch*Math.PI/180),i=Math.cos(ee.pitch*Math.PI/180),r=Math.cos((-t.yaw+ee.yaw)*Math.PI/180),s=a*n+o*r*i;if(90>=t.yaw&&-90<t.yaw&&0>=s||(90<t.yaw||-90>=t.yaw)&&0>=s)t.div.style.visibility="hidden";else{var l=Math.sin((-t.yaw+ee.yaw)*Math.PI/180),h=Math.tan(ee.hfov*Math.PI/360);t.div.style.visibility="visible";var c=te.getCanvas(),u=c.width/(e.devicePixelRatio||1),c=c.height/(e.devicePixelRatio||1),a=[-u/h*l*o/s/2,-u/h*(a*i-o*r*n)/s/2],o=Math.sin(ee.roll*Math.PI/180),n=Math.cos(ee.roll*Math.PI/180),a=[a[0]*n-a[1]*o,a[0]*o+a[1]*n];a[0]+=(u-t.div.offsetWidth)/2,a[1]+=(c-t.div.offsetHeight)/2,u="translate("+a[0]+"px, "+a[1]+"px) translateZ(9999px) rotate("+ee.roll+"deg)",t.div.style.webkitTransform=u,t.div.style.MozTransform=u,t.div.style.transform=u}}function G(e){ee={};var t,a="haov vaov vOffset northOffset horizonPitch horizonRoll".split(" ");Te=[];for(t in Ce)Ce.hasOwnProperty(t)&&(ee[t]=Ce[t]);for(t in n.default)n.default.hasOwnProperty(t)&&(ee[t]=n.default[t],0<=a.indexOf(t)&&Te.push(t));if(null!==e&&""!==e&&n.scenes&&n.scenes[e]){var o=n.scenes[e];for(t in o)o.hasOwnProperty(t)&&(ee[t]=o[t],0<=a.indexOf(t)&&Te.push(t));ee.scene=e}for(t in n)n.hasOwnProperty(t)&&(ee[t]=n[t],0<=a.indexOf(t)&&Te.push(t))}function H(){if("preview"in ee){var e=ee.preview;ee.basePath&&(e=ee.basePath+e),ae=t.createElement("div"),ae.className="pnlm-preview-img",ae.style.backgroundImage="url('"+encodeURI(e)+"')",Ae.appendChild(ae)}ee.hasOwnProperty("title")||(Ne.title.innerHTML=""),ee.hasOwnProperty("author")||(Ne.author.innerHTML=""),ee.hasOwnProperty("title")||ee.hasOwnProperty("author")||(Ne.container.style.display="none");for(var o in ee)if(ee.hasOwnProperty(o))switch(o){case"title":Ne.title.innerHTML=Q(ee[o]),Ne.container.style.display="inline";break;case"author":Ne.author.innerHTML="by "+Q(ee[o]),Ne.container.style.display="inline";break;case"fallback":Ne.errorMsg.innerHTML='<p>Your browser does not support WebGL.<br><a href="'+encodeURI(ee[o])+'" target="_blank">Click here to view this panorama in an alternative viewer.</a></p>';break;case"hfov":W(Number(ee[o]));break;case"autoLoad":!0===ee[o]&&te===a&&(Ne.load.box.style.display="inline",Ue.load.style.display="none",i());break;case"showZoomCtrl":Ue.zoom.style.display=ee[o]&&0!=ee.showControls?"block":"none";break;case"showFullscreenCtrl":Ue.fullscreen.style.display=ee[o]&&0!=ee.showControls&&("fullscreen"in t||"mozFullScreen"in t||"webkitIsFullScreen"in t||"msFullscreenElement"in t)?"block":"none";break;case"hotSpotDebug":ke.style.display=ee[o]?"block":"none";break;case"showControls":ee[o]||(Ue.orientation.style.display="none",Ue.zoom.style.display="none",Ue.fullscreen.style.display="none");break;case"orientationOnByDefault":ee[o]&&K()}}function Y(){if(ye&&!we)if(ge)t.exitFullscreen?t.exitFullscreen():t.mozCancelFullScreen?t.mozCancelFullScreen():t.webkitCancelFullScreen?t.webkitCancelFullScreen():t.msExitFullscreen&&t.msExitFullscreen();else try{o.requestFullscreen?o.requestFullscreen():o.mozRequestFullScreen?o.mozRequestFullScreen():o.msRequestFullscreen?o.msRequestFullscreen():o.webkitRequestFullScreen()}catch(e){}}function X(){t.fullscreen||t.mozFullScreen||t.webkitIsFullScreen||t.msFullscreenElement?(Ue.fullscreen.classList.add("pnlm-fullscreen-toggle-button-active"),ge=!0):(Ue.fullscreen.classList.remove("pnlm-fullscreen-toggle-button-active"),ge=!1),te.resize(),W(ee.hfov),C()}function q(e){var t=ee.minHfov;return"multires"==ee.type&&te&&(t=Math.min(t,te.getCanvas().width/(ee.multiRes.cubeResolution/90*.9))),t>ee.maxHfov?(console.log("HFOV bounds do not make sense (minHfov > maxHfov)."),ee.hfov):e<t?t:e>ee.maxHfov?ee.maxHfov:e}function W(e){ee.hfov=q(e)}function Z(){Re={},Pe=ee.autoRotate?ee.autoRotate:Pe,ee.autoRotate=!1}function V(){we&&(Ne.load.box.style.display="none",Ne.errorMsg.style.display="none",we=!1,$("errorcleared")),Ue.load.style.display="none",Ne.load.box.style.display="inline",i()}function j(e,t,o,i,r){ye=!1,Re={};var s,l;ee.sceneFadeDuration&&!r?(r=new Image,r.className="pnlm-fade-img",r.style.transition="opacity "+ee.sceneFadeDuration/1e3+"s",r.style.width="100%",r.style.height="100%",r.onload=function(){j(e,t,o,i,!0)},s=te.render(ee.pitch*Math.PI/180,ee.yaw*Math.PI/180,ee.hfov*Math.PI/180,{returnImage:!0}),s!==a&&(r.src=s),Ae.appendChild(r),te.fadeImg=r):(r="same"===t?ee.pitch:t,s="same"===o?ee.yaw:"sameAzimuth"===o?ee.yaw+ee.northOffset-n.scenes[e].northOffset:o,l="same"===i?ee.hfov:i,z(),G(e),be.yaw=be.pitch=be.hfov=0,H(),r!==a&&(ee.pitch=r),s!==a&&(ee.yaw=s),l!==a&&(ee.hfov=l),$("scenechange",e),V())}function J(){e.removeEventListener("deviceorientation",N),Ue.orientation.classList.remove("pnlm-orientation-button-active"),Me=!1}function K(){Me=!0,e.addEventListener("deviceorientation",N),Ue.orientation.classList.add("pnlm-orientation-button-active"),requestAnimationFrame(A)}function Q(e){return String(e).replace(/&/g,"&amp;").replace('"',"&quot;").replace("'","&#39;").replace("<","&lt;").replace(">","&gt;").replace("/","&#x2f;")}function $(e){if(e in _e)for(var t=0;t<_e[e].length;t++)_e[e][t].apply(null,[].slice.call(arguments,1))}var ee,te,ae,oe,ne,ie,re,se,le=this,he=!1,ce=Date.now(),ue=0,de=0,fe=-1,me=0,pe=0,ve=Array(10),ge=!1,ye=!1,we=!1,xe=!1,be={yaw:0,pitch:0,hfov:0},Ee=!1,Me=!1,Pe=0,Re={},_e={},Te=[],Le=!1,Ie=!1,Ce={hfov:100,minHfov:50,maxHfov:120,pitch:0,minPitch:a,maxPitch:a,yaw:0,minYaw:-180,maxYaw:180,roll:0,haov:360,vaov:180,vOffset:0,autoRotate:!1,autoRotateInactivityDelay:-1,autoRotateStopDelay:a,type:"equirectangular",northOffset:0,showFullscreenCtrl:!0,dynamic:!1,keyboardZoom:!0,mouseZoom:!0,showZoomCtrl:!0,autoLoad:!1,showControls:!0,orientationOnByDefault:!1,hotSpotDebug:!1,backgroundColor:[0,0,0]};o="string"==typeof o?t.getElementById(o):o,o.classList.add("pnlm-container"),o.tabIndex=0;var Ae=t.createElement("div");Ae.className="pnlm-render-container",o.appendChild(Ae);var De=t.createElement("div");De.className="pnlm-dragfix",o.appendChild(De);var Se=t.createElement("span");Se.className="pnlm-about-msg",Se.innerHTML='<a href="https://pannellum.org/" target="_blank">Pannellum</a> 2.3.2',o.appendChild(Se),De.addEventListener("contextmenu",c);var Ne={},ke=t.createElement("div");ke.className="pnlm-sprite pnlm-hot-spot-debug-indicator",o.appendChild(ke),Ne.container=t.createElement("div"),Ne.container.className="pnlm-panorama-info",Ne.title=t.createElement("div"),Ne.title.className="pnlm-title-box",Ne.container.appendChild(Ne.title),Ne.author=t.createElement("div"),Ne.author.className="pnlm-author-box",Ne.container.appendChild(Ne.author),o.appendChild(Ne.container),Ne.load={},Ne.load.box=t.createElement("div"),Ne.load.box.className="pnlm-load-box",Ne.load.box.innerHTML="<p>Loading...</p>",Ne.load.lbox=t.createElement("div"),Ne.load.lbox.className="pnlm-lbox",Ne.load.lbox.innerHTML='<div class="pnlm-loading"></div>',Ne.load.box.appendChild(Ne.load.lbox),Ne.load.lbar=t.createElement("div"),Ne.load.lbar.className="pnlm-lbar",Ne.load.lbarFill=t.createElement("div"),Ne.load.lbarFill.className="pnlm-lbar-fill",Ne.load.lbar.appendChild(Ne.load.lbarFill),Ne.load.box.appendChild(Ne.load.lbar),Ne.load.msg=t.createElement("p"),Ne.load.msg.className="pnlm-lmsg",Ne.load.box.appendChild(Ne.load.msg),o.appendChild(Ne.load.box),Ne.errorMsg=t.createElement("div"),Ne.errorMsg.className="pnlm-error-msg pnlm-info-box",o.appendChild(Ne.errorMsg);var Ue={};Ue.container=t.createElement("div"),Ue.container.className="pnlm-controls-container",o.appendChild(Ue.container),Ue.load=t.createElement("div"),Ue.load.className="pnlm-load-button",Ue.load.innerHTML="<p>Click to<br>Load<br>Panorama<p>",Ue.load.addEventListener("click",V),o.appendChild(Ue.load),Ue.zoom=t.createElement("div"),Ue.zoom.className="pnlm-zoom-controls pnlm-controls",Ue.zoomIn=t.createElement("div"),Ue.zoomIn.className="pnlm-zoom-in pnlm-sprite pnlm-control",Ue.zoomIn.addEventListener("click",function(){ye&&(W(ee.hfov-5),C())}),Ue.zoom.appendChild(Ue.zoomIn),Ue.zoomOut=t.createElement("div"),Ue.zoomOut.className="pnlm-zoom-out pnlm-sprite pnlm-control",Ue.zoomOut.addEventListener("click",function(){ye&&(W(ee.hfov+5),C())}),Ue.zoom.appendChild(Ue.zoomOut),Ue.container.appendChild(Ue.zoom),Ue.fullscreen=t.createElement("div"),Ue.fullscreen.addEventListener("click",Y),Ue.fullscreen.className="pnlm-fullscreen-toggle-button pnlm-sprite pnlm-fullscreen-toggle-button-inactive pnlm-controls pnlm-control",(t.fullscreenEnabled||t.mozFullScreenEnabled||t.webkitFullscreenEnabled||t.msFullscreenEnabled)&&Ue.container.appendChild(Ue.fullscreen),Ue.orientation=t.createElement("div"),Ue.orientation.addEventListener("click",function(e){Me?J():K()}),Ue.orientation.addEventListener("mousedown",function(e){e.stopPropagation()}),Ue.orientation.addEventListener("touchstart",function(e){e.stopPropagation()}),Ue.orientation.addEventListener("pointerdown",function(e){e.stopPropagation()}),Ue.orientation.className="pnlm-orientation-button pnlm-orientation-button-inactive pnlm-sprite pnlm-controls pnlm-control",e.DeviceOrientationEvent&&e.addEventListener("deviceorientation",function(t){e.removeEventListener("deviceorientation",this),t&&null!==t.alpha&&null!==t.beta&&null!==t.gamma&&Ue.container.appendChild(Ue.orientation)});var Fe=t.createElement("div");Fe.className="pnlm-compass pnlm-controls pnlm-control",o.appendChild(Fe),G(n.firstScene?n.firstScene:n.default&&n.default.firstScene?n.default.firstScene:null),H();var Oe=[],ze=[];S.prototype.multiply=function(e){return new S(this.w*e.w-this.x*e.x-this.y*e.y-this.z*e.z,this.x*e.w+this.w*e.x+this.y*e.z-this.z*e.y,this.y*e.w+this.w*e.y+this.z*e.x-this.x*e.z,this.z*e.w+this.w*e.z+this.x*e.y-this.y*e.x)},S.prototype.toEulerAngles=function(){return[Math.atan2(2*(this.w*this.x+this.y*this.z),1-2*(this.x*this.x+this.y*this.y)),Math.asin(2*(this.w*this.y-this.z*this.x)),Math.atan2(2*(this.w*this.z+this.x*this.y),1-2*(this.y*this.y+this.z*this.z))]},this.getPitch=function(){return ee.pitch},this.setPitch=function(e,t){return(t=t==a?1e3:Number(t))?Re.pitch={startTime:Date.now(),startPosition:ee.pitch,endPosition:e,duration:t}:ee.pitch=e,C(),this},this.getPitchBounds=function(){return[ee.minPitch,ee.maxPitch]},this.setPitchBounds=function(e){return ee.minPitch=Math.max(-90,Math.min(e[0],90)),ee.maxPitch=Math.max(-90,Math.min(e[1],90)),this},this.getYaw=function(){return ee.yaw},this.setYaw=function(e,t){for(;180<e;)e-=360;for(;-180>e;)e+=360;return(t=t==a?1e3:Number(t))?Re.yaw={startTime:Date.now(),startPosition:ee.yaw,endPosition:e,duration:t}:ee.yaw=e,C(),this},this.getYawBounds=function(){return[ee.minYaw,ee.maxYaw]},this.setYawBounds=function(e){return ee.minYaw=Math.max(-180,Math.min(e[0],180)),ee.maxYaw=Math.max(-180,Math.min(e[1],180)),this},this.getHfov=function(){return ee.hfov},this.setHfov=function(e,t){return(t=t==a?1e3:Number(t))?Re.hfov={startTime:Date.now(),startPosition:ee.hfov,endPosition:q(e),duration:t}:W(e),C(),this},this.getHfovBounds=function(){return[ee.minHfov,ee.maxHfov]},this.setHfovBounds=function(e){return ee.minHfov=Math.max(0,e[0]),ee.maxHfov=Math.max(0,e[1]),this},this.lookAt=function(e,t,o,n){return n=n==a?1e3:Number(n),e!==a&&this.setPitch(e,n),t!==a&&this.setYaw(t,n),o!==a&&this.setHfov(o,n),this},this.getNorthOffset=function(){return ee.northOffset},this.setNorthOffset=function(e){return ee.northOffset=Math.min(360,Math.max(0,e)),C(),this},this.startAutoRotate=function(e){return e=e||Pe||1,ee.autoRotate=e,le.lookAt(se,a,re,3e3),C(),this},this.stopAutoRotate=function(){return Pe=ee.autoRotate?ee.autoRotate:Pe,ee.autoRotate=!1,ee.autoRotateInactivityDelay=-1,this},this.getRenderer=function(){return te},this.setUpdate=function(e){return Le=!0===e,te===a?s():C(),this},this.mouseEventToCoords=function(e){return f(e)},this.loadScene=function(e,t,a,o){return ye&&j(e,t,a,o),this},this.getScene=function(){return ee.scene},this.addScene=function(e,t){return n.scenes[e]=t,this},this.removeScene=function(e){return!(ee.scene===e||!n.scenes.hasOwnProperty(e))&&(delete n.scenes[e],!0)},this.toggleFullscreen=function(){return Y(),this},this.getConfig=function(){return ee},this.addHotSpot=function(e,t){if(t===a||ee.scene==t)F(e),ee.hotSpots.push(e),B(e);else{if(!n.scenes.hasOwnProperty(t))throw"Invalid scene ID!";n.scenes[t].hotSpots.push(e)}return this},this.removeHotSpot=function(e){if(!ee.hotSpots)return!1;for(var t=0;t<ee.hotSpots.length;t++)if(ee.hotSpots[t].hasOwnProperty("id")&&ee.hotSpots[t].id===e){for(e=ee.hotSpots[t].div;e.parentNode!=Ae;)e=e.parentNode;return Ae.removeChild(e),delete ee.hotSpots[t].div,ee.hotSpots.splice(t,1),!0}return!1},this.on=function(e,t){return _e[e]=_e[e]||[],_e[e].push(t),this},this.off=function(e,t){if(!e)return _e={},this;if(t){var a=_e[e].indexOf(t);0<=a&&_e[e].splice(a,1),_e[e].length=0}else delete _e[e];return this},this.destroy=function(){te&&te.destroy(),xe&&(De.removeEventListener("mousedown",d,!1),t.removeEventListener("mousemove",m,!1),t.removeEventListener("mouseup",p,!1),o.removeEventListener("mousewheel",E,!1),o.removeEventListener("DOMMouseScroll",E,!1),o.removeEventListener("mozfullscreenchange",X,!1),o.removeEventListener("webkitfullscreenchange",X,!1),o.removeEventListener("msfullscreenchange",X,!1),o.removeEventListener("fullscreenchange",X,!1),e.removeEventListener("resize",I,!1),e.removeEventListener("orientationchange",I,!1),o.removeEventListener("keydown",M,!1),o.removeEventListener("keyup",R,!1),o.removeEventListener("blur",P,!1),t.removeEventListener("mouseleave",p,!1),De.removeEventListener("touchstart",v,!1),De.removeEventListener("touchmove",g,!1),De.removeEventListener("touchend",y,!1),De.removeEventListener("pointerdown",w,!1),De.removeEventListener("pointermove",x,!1),De.removeEventListener("pointerup",b,!1),De.removeEventListener("pointerleave",b,!1)),o.innerHTML="",o.classList.remove("pnlm-container"),o.classList.remove("pnlm-grab"),o.classList.remove("pnlm-grabbing")}}return{viewer:function(e,t){return new o(e,t)}}}(window,document),pannellum.viewer("panorama",{type:"equirectangular",compass:!0,autoLoad:!0,autoRotate:-10,hfov:160,autoRotateInactivityDelay:3e3,maxLevel:16,panorama:"car1x.jpg"});